<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="global.css" />
  <link rel="stylesheet" href="signup.css" />
  <title>TOVA Sign Up</title>
</head>

<body>

  <div class="signup-wrapper">

    <div class="signup-card glass">

      <h1 class="page-title text-center">Create Account</h1>
      <p class="text-center text-light mb-20">
        Join TOVA and access all services with one account
      </p>

      <form>

        <!-- Name -->
        <div class="form-group">
          <label for="name">Full Name</label>
          <input id="name" type="text" class="input" placeholder="John Doe" required />
        </div>

        <!-- Email -->
        <div class="form-group">
          <label for="email">Email</label>
          <input id="email" type="email" class="input" placeholder="example@mail.com" required />
        </div>

        <!-- Password -->
        <div class="form-group">
          <label for="password">Password</label>
          <input id="password" type="password" class="input" placeholder="••••••" required />
        </div>

        <!-- Confirm Password -->
        <div class="form-group">
          <label for="confirm">Confirm Password</label>
          <input id="confirm" type="password" class="input" placeholder="••••••" required />
        </div>

        <!-- Signup Button -->
        <button type="submit" class="btn btn-mint mt-20" style="width: 100%;">
          Sign Up
        </button>

        <!-- Already have account -->
        <p class="text-center text-light mt-20">
          Already have an account?
          <a href="index.html" style="color: var(--mint-dark); font-weight: 700;">Log In</a>
        </p>

      </form>

    </div>
  </div>

</body>
<script type="module">
  import { registerUser } from "./auth.js";

  const signupForm = document.querySelector("form");
  const nameInput = document.getElementById("name");
  const emailInput = document.getElementById("email");
  const passwordInput = document.getElementById("password");
  const confirmInput = document.getElementById("confirm");
  const submitBtn = signupForm.querySelector("button[type='submit']");

  signupForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = nameInput.value;
    const email = emailInput.value;
    const password = passwordInput.value;
    const confirm = confirmInput.value;

    if (password !== confirm) {
      alert("Passwords do not match!");
      return;
    }

    submitBtn.disabled = true;
    submitBtn.textContent = "Signing up...";

    try {
      await registerUser(email, password, name);
      alert("Signup successful! Redirecting to portal...");
      window.location.href = "index.html";
    } catch (error) {
      alert("Signup failed: " + error.message);
      submitBtn.disabled = false;
      submitBtn.textContent = "Sign Up";
    }
  });
</script>

</html>